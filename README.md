Very much a PoC only, the code is very ugly
